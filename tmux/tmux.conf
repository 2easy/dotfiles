# vim: foldmethod=marker

# General {{{

# Use Ctrl+A as the leader
set -g prefix C-a
unbind C-b
bind C-a send-prefix

# Force a reload of the tmux.conf file
unbind r
bind r source-file ~/.tmux.conf \; move-window -r\;  display "~/tmux.conf reloaded!"

# Use xterm-256color
set -ga terminal-overrides ",xterm-256color:Tc"
set -g default-terminal "tmux-256color"

# Use vi mappings
setw -g mode-keys vi

# Enable copy with mouse
set -g mouse on
bind -T copy-mode-vi MouseDragEnd1Pane send-keys -X copy-pipe-and-cancel "xclip -se c -i"

# Setup 'v' to begin selection as in Vim
bind -T copy-mode-vi 'v' send-keys -X begin-selection
bind -T copy-mode-vi 'y' send-keys -X copy-pipe-and-cancel 'xclip -in -selection clipboard'

# Start window and pane indices at 1
set -g base-index 1
setw -g pane-base-index 1

# Automatically renumber tmux windows
set -g renumber-windows on

# Activity monitoring
setw -g monitor-activity off
set -g visual-activity off
set -g visual-bell off

# Length of the history
set -g history-limit 100000

# For sending commands to nested tmux sessions
bind-key a send-prefix

# Toggle synchronize-panes
bind y set-window-option synchronize-panes

# }}}

# Status bar {{{

## COLORSCHEME: gruvbox dark
set-option -g status "on"

# default statusbar color
set-option -g status-style bg=#282828,fg=#ebdbb2 # bg=bg1, fg=fg1

# default window title colors
set-window-option -g window-status-style bg=#fabd2f,fg=#3c3836 # bg=yellow, fg=bg1

# default window with an activity alert
set-window-option -g window-status-activity-style bg=#3c3836,fg=#bdae93 # bg=bg1, fg=fg3

# active window title colors
set-window-option -g window-status-current-style bg=#fb4934,fg=#3c3836 # bg=red, fg=bg1

# pane border
set-option -g pane-active-border-style fg=#d5c4a1 #fg2
set-option -g pane-border-style fg=#3c3836 # bg1

# message infos
set-option -g message-style bg=#504945,fg=#ebdbb2 # bg=bg2, fg=fg1

# writing commands inactive
set-option -g message-command-style bg=#504945,fg=#ebdbb2 # bg=fg3, fg=bg1

# pane number display
set-option -g display-panes-active-colour #d5c4a1 #fg2
set-option -g display-panes-colour #3c3836 #bg1

# clock
set-window-option -g clock-mode-colour #83a598 #blue

# bell
set-window-option -g window-status-bell-style bg=#fb4934,fg=#282828 # bg=red, fg=bg

set-option -g status-justify "left"
set-option -g status-left-style none
set-option -g status-left-length "80"
set-option -g status-right-style none
set-option -g status-right-length "80"

set-option -g status-left ""
set-option -g status-right "#{prefix_highlight}"

set-window-option -g window-status-separator ""
set-window-option -g window-status-current-format "#[fg=#282828, bg=#83a598,bold] #W "
set-window-option -g window-status-format "#[fg=#928374, bg=#282828] #W "

# }}}

# Key bindings {{{

# Smart pane switching with awareness of Vim splits.
PILOT_ROOT=$HOME/dotfiles/nvim/plugged/vim-tmux-pilot
source-file $PILOT_ROOT/pilot.tmux

# Don't prompt to kill panes/windows.
bind x kill-pane
bind & kill-window

# Set window split
bind s split-window -h -c "#{pane_current_path}"
bind o split-window -c "#{pane_current_path}"

# Resizing panes
bind z resize-pane -Z
bind - resize-pane -D 20
bind + resize-pane -U 20
bind < resize-pane -L 20
bind > resize-pane -R 20

# }}}

# Plugins {{{
set -g @plugin 'tmux-plugins/tpm'
set -g @plugin 'tmux-plugins/tmux-sensible'
set -g @plugin 'tmux-plugins/tmux-prefix-highlight'

set -g @prefix_highlight_fg '#ebdbb2'
set -g @prefix_highlight_bg '#fb4934'

# Initialize TMUX plugin manager (keep this line at the very bottom of tmux.conf)
run -b '~/.tmux/plugins/tpm/tpm'

# }}}
